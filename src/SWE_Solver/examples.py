from .post_processing import plotSWE
import numpy as np
from scipy.special import erf
from math import sqrt
import random

# Nx = 50
# tEnd = 0.1
# times = [0.0, 0.05, 0.1]

def exampleSWE(state='still_flat', method='C'):
    """
    Helper function to run pre-coded examples
    Input:
        state       The example to run
        method      The method used to run the example
    Output:
        h           The final water height profile
        u           The final water velocity profile
    """
    g = 1

    if state == "still_flat":
        Nx = 50
        B = lambda x: 1
        h0 = [4.0 - B(_ / (Nx-1)) for _ in range(Nx)]
        u0 = [0.0 for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.5, 1.0]
        steadyH = h0
    elif state == "still_tilted":
        Nx = 50
        B = lambda x: x
        h0 = [4.0 - B(_ / (Nx-1)) for _ in range(Nx)]
        u0 = [0.0 for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.5, 1.0]
        steadyH = h0
    elif state == "still_tilted_pert":
        Nx = 50
        B = lambda x: x
        h0 = [4.0 - B(_ / (Nx-1)) + (random.random()-0.5) / 1e4 for _ in range(Nx)]
        u0 = [0.0 + (random.random()-0.5) / 1e4  for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.5, 1.0]
        steadyH = "TBC"
    elif state == "moving_flat":
        Nx = 50
        B = lambda x: 1
        h0 = [4.0 - B(_ / (Nx-1)) for _ in range(Nx)]
        u0 = [1.0 for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.5, 1.0]
        steadyH = h0
    elif state == "moving_tilted":
        Nx = 50
        B = lambda x: x
        h0 = [4.0 - B(_ / (Nx-1)) for _ in range(Nx)]
        u0 = [1.0 for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.5, 1.0]
        steadyH = None
    elif state == "evolving_wave":
        Nx = 100
        B = lambda x: 1
        Amin = 1
        Amax = 1 + sqrt(3)
        T0 = 0.5
        eps = 0.1
        f = lambda T: Amin + (Amax - Amin) / (1 - erf(-T0 / eps)) * (erf((T - T0) / eps) - erf (-T0 / eps))
        h0 = [f(_/ (Nx-1)) for _ in range(Nx)]
        u0 = [2.0 / h0[_] for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.1, 0.5, 1.0]
        steadyH = [1.0000000000023228, 1.0000000000023224, 1.0000000000023235, 1.0000000000023224, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023215, 1.0000000000023237, 1.0000000000023221, 1.0000000000023228, 1.000000000002323, 1.0000000000023228, 1.0000000000023235, 1.0000000000023228, 1.0000000000023241, 1.0000000000023233, 1.0000000000023253, 1.0000000000023253, 1.0000000000023292, 1.0000000000023304, 1.0000000000023388, 1.0000000000023423, 1.0000000000023639, 1.0000000000023703, 1.0000000000024156, 1.0000000000024223, 1.000000000002498, 1.0000000000025058, 1.000000000002606, 1.00000000000262, 1.000000000002744, 1.0000000000028646, 1.0000000000036178, 1.0000000000058942, 1.0000000000178964, 1.000000000067386, 1.0000000003062677, 1.0000000013598296, 1.0000000062985952, 1.000000028465813, 1.0000001312964808, 1.0000005958920684, 1.0000027401932519, 1.0000157198826476, 1.0000454904466385, 1.0001247604156562, 2.731528902919032, 2.731601067601587, 2.731650034099108, 2.731666647074794, 2.73166991871259, 2.7316706763596263, 2.731670566242251, 2.7316705335894147, 2.731670212075598, 2.7316702017564856, 2.7316699827783593, 2.7316700693210993, 2.731669975172893, 2.731670106142503, 2.731670100022602, 2.7316702281317156, 2.7316703030284457, 2.7316704352006322, 2.731670587042387, 2.7316707219817356, 2.7316709339516865, 2.731671069575952, 2.7316713255697938, 2.731671460940251, 2.731671746377446, 2.731671881464577, 2.7316721835794886, 2.731672318794107, 2.7316726275456995, 2.7316727632062565, 2.731673071642147, 2.731673207403172, 2.7316735112048853, 2.7316736460196256, 2.7316739426200236, 2.7316740755452886, 2.731674362898729, 2.7316744937732844, 2.731674769437767, 2.731674898819269, 2.7316751597712727, 2.731675288408896, 2.7316755314437136, 2.7316756599015424, 2.7316758823832856, 2.7316760109148968, 2.731676212185328, 2.731676340562789, 2.731676522184173, 2.731676650692771, 2.7316768322419147, 2.731676953168804, 2.731677045963039]
    elif state == "standing_wave":
        Nx = 100
        B = lambda x: 1
        h0 = [1.0000000000023228, 1.0000000000023224, 1.0000000000023235, 1.0000000000023224, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023215, 1.0000000000023237, 1.0000000000023221, 1.0000000000023228, 1.000000000002323, 1.0000000000023228, 1.0000000000023235, 1.0000000000023228, 1.0000000000023241, 1.0000000000023233, 1.0000000000023253, 1.0000000000023253, 1.0000000000023292, 1.0000000000023304, 1.0000000000023388, 1.0000000000023423, 1.0000000000023639, 1.0000000000023703, 1.0000000000024156, 1.0000000000024223, 1.000000000002498, 1.0000000000025058, 1.000000000002606, 1.00000000000262, 1.000000000002744, 1.0000000000028646, 1.0000000000036178, 1.0000000000058942, 1.0000000000178964, 1.000000000067386, 1.0000000003062677, 1.0000000013598296, 1.0000000062985952, 1.000000028465813, 1.0000001312964808, 1.0000005958920684, 1.0000027401932519, 1.0000157198826476, 1.0000454904466385, 1.0001247604156562, 2.731528902919032, 2.731601067601587, 2.731650034099108, 2.731666647074794, 2.73166991871259, 2.7316706763596263, 2.731670566242251, 2.7316705335894147, 2.731670212075598, 2.7316702017564856, 2.7316699827783593, 2.7316700693210993, 2.731669975172893, 2.731670106142503, 2.731670100022602, 2.7316702281317156, 2.7316703030284457, 2.7316704352006322, 2.731670587042387, 2.7316707219817356, 2.7316709339516865, 2.731671069575952, 2.7316713255697938, 2.731671460940251, 2.731671746377446, 2.731671881464577, 2.7316721835794886, 2.731672318794107, 2.7316726275456995, 2.7316727632062565, 2.731673071642147, 2.731673207403172, 2.7316735112048853, 2.7316736460196256, 2.7316739426200236, 2.7316740755452886, 2.731674362898729, 2.7316744937732844, 2.731674769437767, 2.731674898819269, 2.7316751597712727, 2.731675288408896, 2.7316755314437136, 2.7316756599015424, 2.7316758823832856, 2.7316760109148968, 2.731676212185328, 2.731676340562789, 2.731676522184173, 2.731676650692771, 2.7316768322419147, 2.731676953168804, 2.731677045963039]
        # h0 = [1.000000000002324, 1.0000000000023221, 1.000000000002324, 1.000000000002322, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023221, 1.0000000000023237, 1.0000000000023224, 1.0000000000023241, 1.0000000000023228, 1.0000000000023246, 1.0000000000023241, 1.000000000002326, 1.0000000000023275, 1.0000000000023284, 1.000000000002335, 1.0000000000023388, 1.000000000002367, 1.0000000000023885, 1.0000000000025144, 1.0000000000026277, 1.000000000003256, 1.0000000000038733, 1.0000000000071585, 1.0000000000104896, 1.0000000000279592, 1.0000000000458744, 1.0000000001393352, 1.0000000002355829, 1.0000000007366894, 1.0000000012535961, 1.000000003942539, 1.0000000067180204, 1.000000021151281, 1.0000000360502783, 1.0000001135264376, 1.0000001934795526, 1.0000006092922373, 1.0000010382089703, 1.0000032687257492, 1.0000055698702848, 1.0000175225553014, 1.0000298946653705, 1.0000878404891733, 1.0001473043756706, 2.731523232854852, 2.7315667492538576, 2.7316091121886394, 2.731626802097693, 2.7316413573541505, 2.7316473617289825, 2.73165337080106, 2.731655162149523, 2.7316596343950335, 2.731659175723322, 2.7316630083061066, 2.7316613376823424, 2.731664825656859, 2.731662502263461, 2.7316658045812576, 2.73166312961249, 2.7316663319250662, 2.7316634676027776, 2.7316666160720438, 2.731663649768962, 2.731666769267218, 2.7316637480501726, 2.731666851964976, 2.7316638011970777, 2.731666896722018, 2.7316638300761045, 2.7316669210702216, 2.73166384591805, 2.7316669344511983, 2.7316638547652525, 2.731666941950842, 2.731663859868939, 2.7316669463099075, 2.7316638629805308, 2.7316669490062386, 2.7316638650462104, 2.7316669508371287, 2.731663866580378, 2.7316669522315293, 2.73166386786919, 2.7316669534104583, 2.7316638690978756, 2.731666954431173, 2.73166387051717, 2.7316669549831674, 2.7316638730600853, 2.731666953052424, 2.7316638815096943, 2.731666937607246, 2.7316639214610983, 2.7316668491827523, 2.731664130539921, 2.731666367808859]
        # h0 = [1.000000000002324, 1.0000000000023221, 1.000000000002324, 1.000000000002322, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023221, 1.0000000000023237, 1.0000000000023221, 1.0000000000023244, 1.0000000000023226, 1.0000000000023248, 1.0000000000023241, 1.0000000000023266, 1.0000000000023284, 1.0000000000023308, 1.0000000000023384, 1.0000000000023426, 1.0000000000023725, 1.0000000000023934, 1.0000000000025235, 1.000000000002639, 1.0000000000032763, 1.0000000000038956, 1.000000000007196, 1.000000000010533, 1.0000000000280218, 1.0000000000459583, 1.0000000001394207, 1.0000000002357567, 1.000000000736812, 1.0000000012540309, 1.000000003942964, 1.0000000067193635, 1.000000021153624, 1.000000036054693, 1.0000001135377663, 1.0000001934941938, 1.0000006093446836, 1.0000010382672835, 1.0000032689796603, 1.0000055701523634, 1.0000175236068058, 1.0000298957792393, 1.0000878430600608, 1.0001473078865868, 2.731523217805919, 2.7315667354664654, 2.7316091000712674, 2.731626791072859, 2.7316413473057066, 2.7316473524014477, 2.731653361752914, 2.7316551536754488, 2.7316596260472306, 2.7316591677657702, 2.731663000570604, 2.7316613300790076, 2.73166481840306, 2.7316624948979116, 2.731665797648354, 2.7316631223945045, 2.7316663251460396, 2.7316634604393797, 2.731666609289672, 2.7316636425491603, 2.731666762343897, 2.7316637406486888, 2.731666844786192, 2.7316637934876713, 2.731666889194166, 2.7316638219441214, 2.7316669131151956, 2.7316638372667907, 2.731666926000449, 2.731663845515726, 2.7316669329405414, 2.7316638499552197, 2.7316669366776503, 2.7316638523434484, 2.7316669386890156, 2.7316638536274835, 2.7316669397701197, 2.7316638543182874, 2.731666940347312, 2.7316638546960803, 2.731666940638392, 2.7316638549392023, 2.7316669406968486, 2.7316638552917225, 2.7316669402080307, 2.7316638566817906, 2.731666937154576, 2.7316638638955255, 2.7316669205084247, 2.731663902569588, 2.7316668308464176, 2.731664110563391, 2.7316663484332255]
        u0 = [1.9999999999976823, 1.9999999999976827, 1.9999999999976814, 1.9999999999976827, 1.9999999999976814, 1.9999999999976832, 1.9999999999976823, 1.999999999997684, 1.999999999997681, 1.999999999997684, 1.9999999999976814, 1.9999999999976832, 1.999999999997681, 1.9999999999976823, 1.999999999997681, 1.999999999997681, 1.999999999997681, 1.999999999997681, 1.9999999999976792, 1.9999999999976774, 1.9999999999976743, 1.9999999999976676, 1.999999999997661, 1.9999999999976388, 1.999999999997633, 1.9999999999975855, 1.9999999999975797, 1.9999999999975024, 1.9999999999974998, 1.9999999999973959, 1.9999999999973883, 1.9999999999972613, 1.9999999999971476, 1.999999999996387, 1.9999999999941354, 1.9999999999821032, 1.9999999999325482, 1.9999999996943405, 1.9999999986373225, 1.9999999937127, 1.999999971494253, 1.9999998688342178, 1.999999403702391, 1.9999972609680583, 1.9999868019592946, 1.9999510334755681, 1.9998572781836024, 0.7322312544515429, 0.7321919941896469, 0.732167340917676, 0.7321564128839376, 0.7321546267998041, 0.7321543196008243, 0.7321545937426892, 0.7321546756935745, 0.7321551376537301, 0.7321552142491554, 0.7321556123669456, 0.7321556552060208, 0.7321559911119906, 0.7321560235520658, 0.7321563340706057, 0.7321563732999883, 0.7321566600134662, 0.7321567032561279, 0.7321569662869268, 0.7321570139370546, 0.7321572608666228, 0.7321573140047053, 0.7321575509670124, 0.7321576103383853, 0.7321578404486616, 0.7321579061227824, 0.7321581300407548, 0.7321582013833667, 0.7321584183757798, 0.7321584941951558, 0.7321587030175685, 0.732158781695864, 0.7321589812754935, 0.7321590610510176, 0.7321592509186454, 0.7321593304611266, 0.7321595105619471, 0.7321595893275104, 0.7321597594942745, 0.7321598375828549, 0.7321599971562343, 0.732160074901307, 0.7321602227484199, 0.7321603004331512, 0.7321604354070701, 0.7321605131584368, 0.7321606350888814, 0.7321607127565564, 0.7321608227021928, 0.7321609004527927, 0.732161010315315, 0.7321610834807661, 0.7321611396285493]
        # u0 = [1.9999999999976805, 1.9999999999976832, 1.9999999999976805, 1.9999999999976836, 1.9999999999976814, 1.9999999999976836, 1.9999999999976814, 1.9999999999976836, 1.9999999999976805, 1.9999999999976832, 1.9999999999976796, 1.9999999999976823, 1.9999999999976792, 1.999999999997681, 1.999999999997677, 1.9999999999976779, 1.9999999999976756, 1.999999999997672, 1.9999999999976663, 1.999999999997645, 1.9999999999976161, 1.9999999999975158, 1.9999999999973728, 1.9999999999968656, 1.9999999999961022, 1.999999999993432, 1.999999999989353, 1.9999999999750897, 1.9999999999532547, 1.999999999876802, 1.9999999997597153, 1.9999999993494924, 1.999999998721076, 1.9999999965191746, 1.9999999931458046, 1.999999981325074, 1.9999999632199237, 1.9999998997607034, 1.9999998026210557, 1.9999994620248116, 1.999998940964773, 1.9999971144428903, 1.9999943178750976, 1.9999845467885562, 1.9999694847051162, 1.9999207012171858, 1.9998357294806846, 0.7322465931768093, 0.7322058267428256, 0.732190902802806, 0.7321737427681931, 0.7321704583872994, 0.7321630247166547, 0.7321632407678338, 0.7321584231534966, 0.7321594513911952, 0.7321559951669732, 0.7321574104361813, 0.7321546875645872, 0.7321563112698635, 0.7321539834367891, 0.7321557193844024, 0.7321536043407084, 0.732155400736728, 0.7321534003032495, 0.7321552292660959, 0.7321532905562957, 0.7321551370733694, 0.7321532316055666, 0.7321550875857356, 0.7321532000282139, 0.7321550611038348, 0.7321531832079547, 0.7321550470179545, 0.7321531743473171, 0.7321550396154554, 0.7321531697834125, 0.7321550358220025, 0.7321531675433037, 0.7321550339843618, 0.7321531665659621, 0.7321550332144175, 0.7321531662827084, 0.732155033035599, 0.7321531663909117, 0.732155033191638, 0.7321531667336221, 0.7321550335389402, 0.7321531672455068, 0.7321550339631239, 0.7321531679829784, 0.732155034196285, 0.7321531694593982, 0.732155032976905, 0.7321531745412949, 0.7321550236073008, 0.7321531987001066, 0.7321549700963289, 0.7321533251973987, 0.7321546788417387]
        # u0 = [1.9999999999976805, 1.9999999999976832, 1.9999999999976805, 1.9999999999976836, 1.9999999999976814, 1.9999999999976836, 1.9999999999976814, 1.9999999999976836, 1.9999999999976805, 1.9999999999976836, 1.9999999999976792, 1.9999999999976832, 1.9999999999976792, 1.9999999999976814, 1.999999999997677, 1.9999999999976783, 1.9999999999976739, 1.9999999999976699, 1.9999999999976623, 1.9999999999976406, 1.9999999999976104, 1.99999999999751, 1.9999999999973612, 1.99999999999685, 1.9999999999960831, 1.9999999999934013, 1.9999999999893125, 1.999999999975035, 1.999999999953165, 1.9999999998767106, 1.9999999997595035, 1.999999999349265, 1.9999999987205808, 1.999999996518258, 1.9999999931447232, 1.9999999813211722, 1.999999963217765, 1.9999998997462989, 1.9999998026155246, 1.999999461974138, 1.999998940931349, 1.9999971142428057, 1.999994317642488, 1.999984546026474, 1.9999694836306015, 1.9999206992250878, 1.9998357246506033, 0.7322465987193186, 0.7322058308101967, 0.7321909065063749, 0.7321737452810253, 0.7321704606331398, 0.7321630261560245, 0.7321632419743875, 0.7321584237301647, 0.7321594517110039, 0.7321559948769304, 0.7321574099656635, 0.7321546864712466, 0.7321563101289678, 0.7321539816684873, 0.7321557176779395, 0.732153602027552, 0.7321553985381533, 0.7321533975413271, 0.7321552266216984, 0.7321532873990209, 0.7321551340116635, 0.732153228070946, 0.7321550841243867, 0.7321531961118671, 0.7321550572527962, 0.7321531788949664, 0.7321550427801582, 0.732153169619754, 0.7321550349866818, 0.7321531646232822, 0.7321550307908943, 0.7321531619323103, 0.7321550285328436, 0.7321531604837517, 0.7321550273183973, 0.7321531597049276, 0.7321550266657317, 0.7321531592878311, 0.7321550263139929, 0.7321531590695511, 0.732155026115486, 0.7321531589789063, 0.7321550259520233, 0.7321531590670988, 0.7321550255521323, 0.7321531598437336, 0.7321550236515371, 0.7321531641766257, 0.7321550135542563, 0.7321531875619829, 0.7321549592940558, 0.7321533134025717, 0.7321546674104993]
        tEnd = 1.0
        timePoints = [0.0, 0.1, 0.5, 1.0]
        steadyH = [1.000000000002324, 1.0000000000023221, 1.000000000002324, 1.000000000002322, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023221, 1.0000000000023237, 1.0000000000023221, 1.0000000000023244, 1.0000000000023226, 1.0000000000023248, 1.0000000000023241, 1.0000000000023266, 1.0000000000023284, 1.0000000000023308, 1.0000000000023384, 1.0000000000023426, 1.0000000000023725, 1.0000000000023934, 1.0000000000025235, 1.000000000002639, 1.0000000000032763, 1.0000000000038956, 1.000000000007196, 1.000000000010533, 1.0000000000280218, 1.0000000000459583, 1.0000000001394207, 1.0000000002357567, 1.000000000736812, 1.0000000012540309, 1.000000003942964, 1.0000000067193635, 1.000000021153624, 1.000000036054693, 1.0000001135377663, 1.0000001934941938, 1.0000006093446836, 1.0000010382672835, 1.0000032689796603, 1.0000055701523634, 1.0000175236068058, 1.0000298957792393, 1.0000878430600608, 1.0001473078865868, 2.731523217805919, 2.7315667354664654, 2.7316091000712674, 2.731626791072859, 2.7316413473057066, 2.7316473524014477, 2.731653361752914, 2.7316551536754488, 2.7316596260472306, 2.7316591677657702, 2.731663000570604, 2.7316613300790076, 2.73166481840306, 2.7316624948979116, 2.731665797648354, 2.7316631223945045, 2.7316663251460396, 2.7316634604393797, 2.731666609289672, 2.7316636425491603, 2.731666762343897, 2.7316637406486888, 2.731666844786192, 2.7316637934876713, 2.731666889194166, 2.7316638219441214, 2.7316669131151956, 2.7316638372667907, 2.731666926000449, 2.731663845515726, 2.7316669329405414, 2.7316638499552197, 2.7316669366776503, 2.7316638523434484, 2.7316669386890156, 2.7316638536274835, 2.7316669397701197, 2.7316638543182874, 2.731666940347312, 2.7316638546960803, 2.731666940638392, 2.7316638549392023, 2.7316669406968486, 2.7316638552917225, 2.7316669402080307, 2.7316638566817906, 2.731666937154576, 2.7316638638955255, 2.7316669205084247, 2.731663902569588, 2.7316668308464176, 2.731664110563391, 2.7316663484332255]
    elif state == "standing_wave_pert":
        Nx = 100
        B = lambda x: 1
        steadyH = [1.0000000000023228, 1.0000000000023224, 1.0000000000023235, 1.0000000000023224, 1.0000000000023235, 1.0000000000023221, 1.0000000000023233, 1.0000000000023215, 1.0000000000023237, 1.0000000000023221, 1.0000000000023228, 1.000000000002323, 1.0000000000023228, 1.0000000000023235, 1.0000000000023228, 1.0000000000023241, 1.0000000000023233, 1.0000000000023253, 1.0000000000023253, 1.0000000000023292, 1.0000000000023304, 1.0000000000023388, 1.0000000000023423, 1.0000000000023639, 1.0000000000023703, 1.0000000000024156, 1.0000000000024223, 1.000000000002498, 1.0000000000025058, 1.000000000002606, 1.00000000000262, 1.000000000002744, 1.0000000000028646, 1.0000000000036178, 1.0000000000058942, 1.0000000000178964, 1.000000000067386, 1.0000000003062677, 1.0000000013598296, 1.0000000062985952, 1.000000028465813, 1.0000001312964808, 1.0000005958920684, 1.0000027401932519, 1.0000157198826476, 1.0000454904466385, 1.0001247604156562, 2.731528902919032, 2.731601067601587, 2.731650034099108, 2.731666647074794, 2.73166991871259, 2.7316706763596263, 2.731670566242251, 2.7316705335894147, 2.731670212075598, 2.7316702017564856, 2.7316699827783593, 2.7316700693210993, 2.731669975172893, 2.731670106142503, 2.731670100022602, 2.7316702281317156, 2.7316703030284457, 2.7316704352006322, 2.731670587042387, 2.7316707219817356, 2.7316709339516865, 2.731671069575952, 2.7316713255697938, 2.731671460940251, 2.731671746377446, 2.731671881464577, 2.7316721835794886, 2.731672318794107, 2.7316726275456995, 2.7316727632062565, 2.731673071642147, 2.731673207403172, 2.7316735112048853, 2.7316736460196256, 2.7316739426200236, 2.7316740755452886, 2.731674362898729, 2.7316744937732844, 2.731674769437767, 2.731674898819269, 2.7316751597712727, 2.731675288408896, 2.7316755314437136, 2.7316756599015424, 2.7316758823832856, 2.7316760109148968, 2.731676212185328, 2.731676340562789, 2.731676522184173, 2.731676650692771, 2.7316768322419147, 2.731676953168804, 2.731677045963039]
        steadyU = [1.9999999999976823, 1.9999999999976827, 1.9999999999976814, 1.9999999999976827, 1.9999999999976814, 1.9999999999976832, 1.9999999999976823, 1.999999999997684, 1.999999999997681, 1.999999999997684, 1.9999999999976814, 1.9999999999976832, 1.999999999997681, 1.9999999999976823, 1.999999999997681, 1.999999999997681, 1.999999999997681, 1.999999999997681, 1.9999999999976792, 1.9999999999976774, 1.9999999999976743, 1.9999999999976676, 1.999999999997661, 1.9999999999976388, 1.999999999997633, 1.9999999999975855, 1.9999999999975797, 1.9999999999975024, 1.9999999999974998, 1.9999999999973959, 1.9999999999973883, 1.9999999999972613, 1.9999999999971476, 1.999999999996387, 1.9999999999941354, 1.9999999999821032, 1.9999999999325482, 1.9999999996943405, 1.9999999986373225, 1.9999999937127, 1.999999971494253, 1.9999998688342178, 1.999999403702391, 1.9999972609680583, 1.9999868019592946, 1.9999510334755681, 1.9998572781836024, 0.7322312544515429, 0.7321919941896469, 0.732167340917676, 0.7321564128839376, 0.7321546267998041, 0.7321543196008243, 0.7321545937426892, 0.7321546756935745, 0.7321551376537301, 0.7321552142491554, 0.7321556123669456, 0.7321556552060208, 0.7321559911119906, 0.7321560235520658, 0.7321563340706057, 0.7321563732999883, 0.7321566600134662, 0.7321567032561279, 0.7321569662869268, 0.7321570139370546, 0.7321572608666228, 0.7321573140047053, 0.7321575509670124, 0.7321576103383853, 0.7321578404486616, 0.7321579061227824, 0.7321581300407548, 0.7321582013833667, 0.7321584183757798, 0.7321584941951558, 0.7321587030175685, 0.732158781695864, 0.7321589812754935, 0.7321590610510176, 0.7321592509186454, 0.7321593304611266, 0.7321595105619471, 0.7321595893275104, 0.7321597594942745, 0.7321598375828549, 0.7321599971562343, 0.732160074901307, 0.7321602227484199, 0.7321603004331512, 0.7321604354070701, 0.7321605131584368, 0.7321606350888814, 0.7321607127565564, 0.7321608227021928, 0.7321609004527927, 0.732161010315315, 0.7321610834807661, 0.7321611396285493]
        h0 = [h + (random.random() - 0.5) / 1e4 for h in steadyH]
        u0 = [u + (random.random() - 0.5) / 1e4 for u in steadyU]
        tEnd = 1.0
        timePoints = [0.0, 0.1, 0.5, 1.0]
        # if method == 'C':
            # steadyH = "TBC"
    elif state == "forming_collision":
        Nx = 100
        B = lambda x: 1
        h0 = [2.0 for _ in range(Nx)]
        def u(x):
            if 0 <= x <= 0.3:
                return 1
            if 0.3 < x < 0.7:
                return 0
            if 0.7 <= x <= 1:
                return -1
        u0 = [u(_ / (Nx - 1)) for _ in range(Nx)]
        tEnd = 0.5
        timePoints = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5]
        steadyH = None
    elif state == "spike_flattening":
        Nx = 100
        B = lambda x: 1
        f = lambda x: np.exp(- (x - 0.5) ** 2 / (2 * 0.01))
        h0 = [2.0 + f(_ / (Nx - 1)) for _ in range(Nx)]
        u0 = [0 for _ in range(Nx)]
        tEnd = 1.0
        timePoints = [0.0, 0.1, 0.5, 1.0]
        steadyH = None
    elif state == "over_bump":
        Nx = 100
        B = lambda x: np.exp(- (x - 0.5) ** 2 / (2 * 0.01)) # if x <= 0.5 else 1.5 - x
        h0 = [4.0 - B(_ / (Nx - 1)) for _ in range(Nx)]
        u0 = [1 for _ in range(Nx)]
        tEnd = 0.6
        timePoints = [0.0, 0.2, 0.4, 0.6]
        steadyH = None
    elif state == "half_dry":
        Nx = 50
        B = lambda x: 1
        h0 = [4 if _ <= Nx / 2 else 0.1 for _ in range(Nx)]
        u0 = [0 for _ in range(Nx)]
        tEnd = 0.5
        timePoints = [0.0, 0.1, 0.2, 0.5]
        steadyH = None
    else:
        raise ValueError("Example state not implemented")

    return plotSWE(B, h0, u0, Nx, tEnd, timePoints, g, method, steadyH)